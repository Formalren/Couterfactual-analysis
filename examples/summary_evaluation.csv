summary_auto_assignment,summary_evaluation
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: lidar_distance
Node lidar_distance is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: lidar_num_lasers
Node lidar_num_lasers is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: num_scenarios
Node num_scenarios is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: daytime
Node daytime is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: traffic_density
Node traffic_density is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: side_detector_distance
Node side_detector_distance is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: accident_prob
Node accident_prob is a root node. Therefore, assigning 'Empirical Distribution' to the node representing the marginal distribution.

--- Node: out_of_road
Node out_of_road is a non-root node with discrete data. Assigning 'Discrete AdditiveNoiseModel using LinearRegression' to the node.
This represents the discrete causal relationship as out_of_road := f(daytime,lane_line_detector_gaussian_noise,lane_line_detector_num_lasers,lidar_dropout_prob,lidar_gaussian_noise,side_detector_dropout_prob) + N.
For the model selection, the following models were evaluated on the mean squared error (MSE) metric:
LinearRegression: 0.002989134395796883
HistGradientBoostingRegressor: 0.003339283859319709

--- Node: crash_building
Node crash_building is a non-root node with discrete data. Assigning 'Discrete AdditiveNoiseModel using LinearRegression' to the node.
This represents the discrete causal relationship as crash_building := f(accident_prob,daytime,lane_line_detector_distance,lane_line_detector_dropout_prob,lane_line_detector_gaussian_noise,lane_line_detector_num_lasers,lidar_distance,lidar_dropout_prob,lidar_gaussian_noise,lidar_num_lasers,map,num_scenarios,side_detector_distance,side_detector_dropout_prob,side_detector_gaussian_noise,side_detector_num_lasers,traffic_density) + N.
For the model selection, the following models were evaluated on the mean squared error (MSE) metric:
LinearRegression: 0.0
HistGradientBoostingRegressor: 0.0

--- Node: crash_vehicle
Node crash_vehicle is a non-root node with discrete data. Assigning 'Discrete AdditiveNoiseModel using LinearRegression' to the node.
This represents the discrete causal relationship as crash_vehicle := f(accident_prob,lane_line_detector_distance,lidar_distance,lidar_dropout_prob,lidar_gaussian_noise,map,traffic_density) + N.
For the model selection, the following models were evaluated on the mean squared error (MSE) metric:
LinearRegression: 0.09981479351368379
HistGradientBoostingRegressor: 0.10059539621987199

--- Node: crash_human
Node crash_human is a non-root node with discrete data. Assigning 'Discrete AdditiveNoiseModel using LinearRegression' to the node.
This represents the discrete causal relationship as crash_human := f(accident_prob,daytime,lane_line_detector_distance,lane_line_detector_dropout_prob,lane_line_detector_gaussian_noise,lane_line_detector_num_lasers,lidar_distance,lidar_dropout_prob,lidar_gaussian_noise,lidar_num_lasers,map,num_scenarios,side_detector_distance,side_detector_dropout_prob,side_detector_gaussian_noise,side_detector_num_lasers,traffic_density) + N.
For the model selection, the following models were evaluated on the mean squared error (MSE) metric:
LinearRegression: 0.0
HistGradientBoostingRegressor: 0.0

--- Node: crash_object
Node crash_object is a non-root node with discrete data. Assigning 'Discrete AdditiveNoiseModel using HistGradientBoostingRegressor' to the node.
This represents the discrete causal relationship as crash_object := f(accident_prob,lane_line_detector_distance,lane_line_detector_gaussian_noise,lane_line_detector_num_lasers,lidar_distance,lidar_num_lasers,map,num_scenarios,side_detector_dropout_prob,side_detector_num_lasers) + N.
For the model selection, the following models were evaluated on the mean squared error (MSE) metric:
HistGradientBoostingRegressor: 0.013542410915177905
LinearRegression: 0.07960640624388779

--- Node: crash_sidewalk
Node crash_sidewalk is a non-root node with discrete data. Assigning 'Discrete AdditiveNoiseModel using LinearRegression' to the node.
This represents the discrete causal relationship as crash_sidewalk := f(accident_prob,daytime,lane_line_detector_distance,lane_line_detector_dropout_prob,lane_line_detector_gaussian_noise,lane_line_detector_num_lasers,lidar_distance,lidar_dropout_prob,lidar_gaussian_noise,lidar_num_lasers,map,num_scenarios,side_detector_distance,side_detector_dropout_prob,side_detector_gaussian_noise,side_detector_num_lasers,traffic_density) + N.
For the model selection, the following models were evaluated on the mean squared error (MSE) metric:
LinearRegression: 0.0
HistGradientBoostingRegressor: 0.0

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.6014946348670177.
- The R2 coefficient is 0.39700654033204763.
- The normalized CRPS is 0.04205938502506111.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12349220440548189.
- The NMSE is 1.0683722317478135.
- The R2 coefficient is -0.14159701088309343.
- The normalized CRPS is 0.4241458978020044.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.01487543694168562.
- The NMSE is 0.3257165345606259.
- The R2 coefficient is 0.8885068034020603.
- The normalized CRPS is 0.04096568952955528.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00024434682794116647 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 19/358 LMCs and is better than 50.0% of the permuted DAGs (p-value: 0.50).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.6014932399650403.
- The R2 coefficient is 0.39700933534574306.
- The normalized CRPS is 0.04204583843548444.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12348943017255729.
- The NMSE is 1.0682615834421485.
- The R2 coefficient is -0.14128012404900506.
- The normalized CRPS is 0.42538180373896217.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.01562447983132664.
- The NMSE is 0.3380681244028091.
- The R2 coefficient is 0.8834000224035243.
- The normalized CRPS is 0.04304301222842499.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00024782305247073033 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 26/358 LMCs and is better than 76.0% of the permuted DAGs (p-value: 0.24).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.6014946348670177.
- The R2 coefficient is 0.39700654033204763.
- The normalized CRPS is 0.042033919415239006.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12349775287133107.
- The NMSE is 1.0683065546313741.
- The R2 coefficient is -0.1414072912127343.
- The normalized CRPS is 0.4265763816990395.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014880985407534816.
- The NMSE is 0.3287866784353365.
- The R2 coefficient is 0.8831810789936009.
- The normalized CRPS is 0.041989194285541875.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00024836718443621564 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 15/358 LMCs and is better than 86.0% of the permuted DAGs (p-value: 0.14).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.40149883921827756.
- The R2 coefficient is 0.5969952972318436.
- The normalized CRPS is 0.03365833927821726.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.1235338178993508.
- The NMSE is 1.0683508746521686.
- The R2 coefficient is -0.14151627159167285.
- The normalized CRPS is 0.4273628450359278.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014143039449592188.
- The NMSE is 0.32767483337600367.
- The R2 coefficient is 0.888338565777371.
- The normalized CRPS is 0.04007310919313052.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002509631490827946 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 22/358 LMCs and is better than 92.0% of the permuted DAGs (p-value: 0.08).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002979526161016479.
- The NMSE is 0.6014960454862329.
- The R2 coefficient is 0.39700370328807094.
- The normalized CRPS is 0.042034996240658574.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12352272096765245.
- The NMSE is 1.0684619625278855.
- The R2 coefficient is -0.14183204390008122.
- The normalized CRPS is 0.4254385537730183.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.015627254064251233.
- The NMSE is 0.3278449463945061.
- The R2 coefficient is 0.8852606122973479.
- The normalized CRPS is 0.04258783439074014.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00025151273841617083 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 14/358 LMCs and is better than 100.0% of the permuted DAGs (p-value: 0.00).    |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.4014974443163002.
- The R2 coefficient is 0.5969980922455391.
- The normalized CRPS is 0.03364170163400651.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12352272096765245.
- The NMSE is 1.06821226037117.
- The R2 coefficient is -0.1411260660940321.
- The normalized CRPS is 0.42340665515028475.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014880985407534816.
- The NMSE is 0.32687738384936543.
- The R2 coefficient is 0.8854061411559128.
- The normalized CRPS is 0.04159906624017521.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00024360400069944887 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 17/358 LMCs and is better than 76.0% of the permuted DAGs (p-value: 0.24).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.6014946348670177.
- The R2 coefficient is 0.39700654033204763.
- The normalized CRPS is 0.04213905221431968.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12352272096765245.
- The NMSE is 1.0684328544783899.
- The R2 coefficient is -0.14175054863242406.
- The normalized CRPS is 0.42594305068465504.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.01339677079287577.
- The NMSE is 0.3089094531535528.
- The R2 coefficient is 0.8959703005363846.
- The normalized CRPS is 0.03777759800999823.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002450509634397413 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 14/358 LMCs and is better than 96.0% of the permuted DAGs (p-value: 0.04).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.6014932399650403.
- The R2 coefficient is 0.3970093353457431.
- The normalized CRPS is 0.0421392676768942.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12349775287133109.
- The NMSE is 1.0682000007814805.
- The R2 coefficient is -0.14110213983636283.
- The normalized CRPS is 0.4266497756590576.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014872662708761027.
- The NMSE is 0.32367611359165116.
- The R2 coefficient is 0.8859366670604955.
- The normalized CRPS is 0.04144832645782924.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002472985547501416 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 19/358 LMCs and is better than 94.0% of the permuted DAGs (p-value: 0.06).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.6014946348670177.
- The R2 coefficient is 0.3970065403320477.
- The normalized CRPS is 0.04207074668207318.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12353104366642623.
- The NMSE is 1.0683433153378492.
- The R2 coefficient is -0.14149615107315391.
- The normalized CRPS is 0.42497783589769267.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014134716750818399.
- The NMSE is 0.3231029345098597.
- The R2 coefficient is 0.8943225638248551.
- The normalized CRPS is 0.038924649567528516.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002474729918169327 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 17/358 LMCs and is better than 72.0% of the permuted DAGs (p-value: 0.28).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.8014925425146586.
- The R2 coefficient is 0.19701213035943863.
- The normalized CRPS is 0.049374233679989894.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12352272096765245.
- The NMSE is 1.0683463984439507.
- The R2 coefficient is -0.1415074330118961.
- The normalized CRPS is 0.4249341579137571.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014137490983742996.
- The NMSE is 0.3175569628105812.
- The R2 coefficient is 0.8939657582518251.
- The normalized CRPS is 0.03918040418369862.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00024872130774489243 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 19/358 LMCs and is better than 72.0% of the permuted DAGs (p-value: 0.28).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.6014932399650403.
- The R2 coefficient is 0.3970093353457432.
- The normalized CRPS is 0.04206170764836845.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.1234838817067081.
- The NMSE is 1.0686799606702182.
- The R2 coefficient is -0.14247693234296377.
- The normalized CRPS is 0.42491769817783903.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.015627254064251233.
- The NMSE is 0.3325863866331562.
- The R2 coefficient is 0.8820064563662061.
- The normalized CRPS is 0.04320111091427166.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.000246416598416177 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 22/358 LMCs and is better than 70.0% of the permuted DAGs (p-value: 0.30).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002979526161016479.
- The NMSE is 0.6014960454862329.
- The R2 coefficient is 0.39700370328807083.
- The normalized CRPS is 0.04208270882006378.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12351994673472784.
- The NMSE is 1.0681644711287595.
- The R2 coefficient is -0.1409913942436519.
- The normalized CRPS is 0.4237672885064894.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.015621705598402041.
- The NMSE is 0.3399975798324878.
- The R2 coefficient is 0.8802851691310007.
- The normalized CRPS is 0.04348635093088133.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002487051763340187 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 15/358 LMCs and is better than 96.0% of the permuted DAGs (p-value: 0.04).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002979526161016479.
- The NMSE is 0.6014960454862329.
- The R2 coefficient is 0.39700370328807083.
- The normalized CRPS is 0.04207412395501864.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12351439826887867.
- The NMSE is 1.0681429358729573.
- The R2 coefficient is -0.14093242207170825.
- The normalized CRPS is 0.4244007715126288.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.016370748488043055.
- The NMSE is 0.34976937090906524.
- The R2 coefficient is 0.8763150546577666.
- The normalized CRPS is 0.04513157576354724.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002484636041923949 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 26/358 LMCs and is better than 88.0% of the permuted DAGs (p-value: 0.12).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.6014946348670177.
- The R2 coefficient is 0.39700654033204763.
- The normalized CRPS is 0.04207196909596127.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12352272096765245.
- The NMSE is 1.0682320356643862.
- The R2 coefficient is -0.1411821725648875.
- The normalized CRPS is 0.42647324361681516.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014140265216667591.
- The NMSE is 0.3267316390103573.
- The R2 coefficient is 0.8919521409407377.
- The normalized CRPS is 0.03933064686141555.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002479667166725985 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 21/358 LMCs and is better than 76.0% of the permuted DAGs (p-value: 0.24).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.6014932399650403.
- The R2 coefficient is 0.3970093353457431.
- The normalized CRPS is 0.04211497252639268.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12351717250180325.
- The NMSE is 1.0681963302412063.
- The R2 coefficient is -0.1410829924390864.
- The normalized CRPS is 0.4248290203657346.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014889308106308605.
- The NMSE is 0.3272929533718686.
- The R2 coefficient is 0.8830984085953766.
- The normalized CRPS is 0.041893077314064074.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002484636041923949 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 26/358 LMCs and is better than 72.0% of the permuted DAGs (p-value: 0.28).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.6014946348670177.
- The R2 coefficient is 0.39700654033204763.
- The normalized CRPS is 0.04207762777294066.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12350884980302945.
- The NMSE is 1.0683163472992034.
- The R2 coefficient is -0.1414281431344616.
- The normalized CRPS is 0.4246167083906703.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014878211174610221.
- The NMSE is 0.3352774463832826.
- The R2 coefficient is 0.8789614631424183.
- The normalized CRPS is 0.042434077224306.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002511126635469374 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 14/358 LMCs and is better than 98.0% of the permuted DAGs (p-value: 0.02).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.6014946348670177.
- The R2 coefficient is 0.39700654033204763.
- The normalized CRPS is 0.04208206860986734.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12353104366642623.
- The NMSE is 1.0682997153370877.
- The R2 coefficient is -0.14137174727170598.
- The normalized CRPS is 0.42505211753993627.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.015621705598402045.
- The NMSE is 0.34206019854614755.
- The R2 coefficient is 0.8811550355190765.
- The normalized CRPS is 0.04336912983856204.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00024352861793808245 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 11/358 LMCs and is better than 96.0% of the permuted DAGs (p-value: 0.04).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.6014932399650403.
- The R2 coefficient is 0.39700933534574306.
- The normalized CRPS is 0.04209062817303756.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12353104366642624.
- The NMSE is 1.06826085159563.
- The R2 coefficient is -0.14126187440176338.
- The normalized CRPS is 0.42443560999601715.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.01487543694168562.
- The NMSE is 0.3327211312541467.
- The R2 coefficient is 0.8793683111528546.
- The normalized CRPS is 0.04260831308479806.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002466047363747226 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 18/358 LMCs and is better than 70.0% of the permuted DAGs (p-value: 0.30).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002979526161016479.
- The NMSE is 0.6014960454862329.
- The R2 coefficient is 0.3970037032880709.
- The normalized CRPS is 0.0420175300133735.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12351439826887864.
- The NMSE is 1.0682511885468364.
- The R2 coefficient is -0.1412400705244398.
- The normalized CRPS is 0.42566124089718543.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.016365200022193865.
- The NMSE is 0.3457930213261992.
- The R2 coefficient is 0.8770201448193584.
- The normalized CRPS is 0.04516930939330079.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002452049136909551 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 15/358 LMCs and is better than 96.0% of the permuted DAGs (p-value: 0.04).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.4014974443163002.
- The R2 coefficient is 0.5969980922455391.
- The normalized CRPS is 0.03363634173565122.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12350052710425567.
- The NMSE is 1.0681730120646824.
- The R2 coefficient is -0.14102398951700484.
- The normalized CRPS is 0.4253726808852507.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.016365200022193865.
- The NMSE is 0.3472145301627337.
- The R2 coefficient is 0.8744132564373055.
- The normalized CRPS is 0.045592880352090116.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00024668326401644514 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 13/358 LMCs and is better than 94.0% of the permuted DAGs (p-value: 0.06).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.6014932399650404.
- The R2 coefficient is 0.39700933534574306.
- The normalized CRPS is 0.04208122636470095.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.1235338178993508.
- The NMSE is 1.0684651222592714.
- The R2 coefficient is -0.14183955498805365.
- The normalized CRPS is 0.42448465554100945.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.017854963102702102.
- The NMSE is 0.36321084898644457.
- The R2 coefficient is 0.8610762246719256.
- The normalized CRPS is 0.04997831121805455.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00024655765845116306 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 21/358 LMCs and is better than 80.0% of the permuted DAGs (p-value: 0.20).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.8014925425146586.
- The R2 coefficient is 0.19701213035943863.
- The normalized CRPS is 0.04940993158076358.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12351162403595406.
- The NMSE is 1.0684926118054814.
- The R2 coefficient is -0.1419349126326137.
- The normalized CRPS is 0.4256690150858309.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.016365200022193865.
- The NMSE is 0.34101508415791887.
- The R2 coefficient is 0.8792853431161731.
- The normalized CRPS is 0.044674862351465436.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00024785495484280773 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 16/358 LMCs and is better than 98.0% of the permuted DAGs (p-value: 0.02).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002979526161016479.
- The NMSE is 0.40149813783859206.
- The R2 coefficient is 0.5969981132606799.
- The normalized CRPS is 0.03476335635659535.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12350607557010487.
- The NMSE is 1.0681888806136486.
- The R2 coefficient is -0.14106699875027157.
- The normalized CRPS is 0.42378133310695104.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.016370748488043055.
- The NMSE is 0.3492287848871355.
- The R2 coefficient is 0.8774853798772945.
- The normalized CRPS is 0.04493775366166437.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002509631490827946 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 21/358 LMCs and is better than 84.0% of the permuted DAGs (p-value: 0.16).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.8014925425146586.
- The R2 coefficient is 0.19701213035943868.
- The normalized CRPS is 0.04928374140947604.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12350330133718028.
- The NMSE is 1.06848811126132.
- The R2 coefficient is -0.14192829806354293.
- The normalized CRPS is 0.424869193385123.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.01487543694168562.
- The NMSE is 0.32369605985914285.
- The R2 coefficient is 0.8881102421274424.
- The normalized CRPS is 0.04109817884459806.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002474412466271225 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 19/358 LMCs and is better than 98.0% of the permuted DAGs (p-value: 0.02).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.6014946348670177.
- The R2 coefficient is 0.3970065403320477.
- The normalized CRPS is 0.042114776863089336.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12349497863840649.
- The NMSE is 1.0683434526384017.
- The R2 coefficient is -0.14151271811738814.
- The normalized CRPS is 0.4243699440494887.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.01563002829717583.
- The NMSE is 0.3433988773093561.
- The R2 coefficient is 0.8793163945939473.
- The normalized CRPS is 0.043617315176682436.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00025296286467524354 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 13/358 LMCs and is better than 96.0% of the permuted DAGs (p-value: 0.04).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002979526161016479.
- The NMSE is 0.6014960454862329.
- The R2 coefficient is 0.39700370328807094.
- The normalized CRPS is 0.04206888564819024.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12351994673472784.
- The NMSE is 1.0681930780841602.
- The R2 coefficient is -0.14107275808313338.
- The normalized CRPS is 0.42625354719727626.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.017111468678910283.
- The NMSE is 0.3477626939928699.
- The R2 coefficient is 0.867286291759059.
- The normalized CRPS is 0.04791559535808169.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002476160069146971 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 22/358 LMCs and is better than 78.0% of the permuted DAGs (p-value: 0.22).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002979526161016479.
- The NMSE is 0.6014960454862329.
- The R2 coefficient is 0.39700370328807083.
- The normalized CRPS is 0.0420847368941266.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12350052710425567.
- The NMSE is 1.068222057603015.
- The R2 coefficient is -0.14116372275448671.
- The normalized CRPS is 0.42406039172873894.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.015624479831326638.
- The NMSE is 0.3415485932899689.
- The R2 coefficient is 0.8783297100949004.
- The normalized CRPS is 0.04382630791298318.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00024277899082836285 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 23/358 LMCs and is better than 74.0% of the permuted DAGs (p-value: 0.26).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.8014925425146586.
- The R2 coefficient is 0.19701213035943868.
- The normalized CRPS is 0.04933540832356347.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12353381789935083.
- The NMSE is 1.068298008595177.
- The R2 coefficient is -0.14136673695858432.
- The normalized CRPS is 0.4262869826072901.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.015618931365477446.
- The NMSE is 0.338887280631043.
- The R2 coefficient is 0.8727592902745658.
- The normalized CRPS is 0.0448577518960009.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002474412466271225 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 19/358 LMCs and is better than 88.0% of the permuted DAGs (p-value: 0.12).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.6014932399650403.
- The R2 coefficient is 0.39700933534574306.
- The normalized CRPS is 0.04206645708859578.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12350330133718027.
- The NMSE is 1.0683123309674651.
- The R2 coefficient is -0.14142242346655629.
- The normalized CRPS is 0.42558429761557487.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014134716750818399.
- The NMSE is 0.3272776584543518.
- The R2 coefficient is 0.8901252998888138.
- The normalized CRPS is 0.03967461528206162.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002474412466271225 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 27/358 LMCs and is better than 92.0% of the permuted DAGs (p-value: 0.08).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.6014932399650403.
- The R2 coefficient is 0.39700933534574306.
- The normalized CRPS is 0.04205135974952112.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12351162403595406.
- The NMSE is 1.068402744493958.
- The R2 coefficient is -0.14167518275931346.
- The normalized CRPS is 0.42388905734213367.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.016367974255118458.
- The NMSE is 0.35114186758082705.
- The R2 coefficient is 0.8708036590733965.
- The normalized CRPS is 0.04601864889870978.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.000248866640384815 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 21/358 LMCs and is better than 84.0% of the permuted DAGs (p-value: 0.16).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.6014946348670177.
- The R2 coefficient is 0.39700654033204763.
- The normalized CRPS is 0.04209037125163518.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12351994673472784.
- The NMSE is 1.0682715894935935.
- The R2 coefficient is -0.14129517818697898.
- The normalized CRPS is 0.4261239932722547.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.016370748488043055.
- The NMSE is 0.3530001845485748.
- The R2 coefficient is 0.8747115023258154.
- The normalized CRPS is 0.045549777602484506.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002479667166725985 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 17/358 LMCs and is better than 92.0% of the permuted DAGs (p-value: 0.08).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.8014925425146586.
- The R2 coefficient is 0.19701213035943863.
- The normalized CRPS is 0.04932866966676722.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12352826943350163.
- The NMSE is 1.0682121784548118.
- The R2 coefficient is -0.14112421376709433.
- The normalized CRPS is 0.42408176029611366.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.015621705598402045.
- The NMSE is 0.3413201204089118.
- The R2 coefficient is 0.8822604154813266.
- The normalized CRPS is 0.04312668950663058.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002474412466271225 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 26/358 LMCs and is better than 76.0% of the permuted DAGs (p-value: 0.24).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.8014911476126813.
- The R2 coefficient is 0.1970149253731341.
- The normalized CRPS is 0.04928554447688952.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12349775287133107.
- The NMSE is 1.068275550494042.
- The R2 coefficient is -0.1413176957879764.
- The normalized CRPS is 0.4248735531852115.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.015627254064251233.
- The NMSE is 0.3394010033735975.
- The R2 coefficient is 0.8790703681777344.
- The normalized CRPS is 0.04357753086035273.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002506236295136688 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 10/358 LMCs and is better than 100.0% of the permuted DAGs (p-value: 0.00).    |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.6014946348670177.
- The R2 coefficient is 0.3970065403320477.
- The normalized CRPS is 0.04204397616359662.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12352549520057703.
- The NMSE is 1.0683419271520131.
- The R2 coefficient is -0.1414946418819772.
- The normalized CRPS is 0.42595981318577814.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.013391222327026577.
- The NMSE is 0.3055738850650065.
- The R2 coefficient is 0.8950488786470938.
- The normalized CRPS is 0.03775346111136257.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002485279503494642 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 20/358 LMCs and is better than 90.0% of the permuted DAGs (p-value: 0.10).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002979526161016479.
- The NMSE is 0.6014960454862329.
- The R2 coefficient is 0.3970037032880709.
- The normalized CRPS is 0.042067469044178483.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12350052710425567.
- The NMSE is 1.068522202133857.
- The R2 coefficient is -0.14202582358683574.
- The normalized CRPS is 0.42560512507391646.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014134716750818396.
- The NMSE is 0.32577119856292036.
- The R2 coefficient is 0.8895080009089138.
- The normalized CRPS is 0.039780282473168296.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002479667166725985 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 10/358 LMCs and is better than 98.0% of the permuted DAGs (p-value: 0.02).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.4014974443163002.
- The R2 coefficient is 0.5969980922455391.
- The normalized CRPS is 0.033629565575221836.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12350052710425567.
- The NMSE is 1.0682161515858741.
- The R2 coefficient is -0.14114681828576078.
- The normalized CRPS is 0.4244976674328164.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.015621705598402045.
- The NMSE is 0.3395577326944409.
- The R2 coefficient is 0.8801657080116858.
- The normalized CRPS is 0.043260445439077755.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002452203260296937 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 30/358 LMCs and is better than 58.0% of the permuted DAGs (p-value: 0.42).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.6014946348670177.
- The R2 coefficient is 0.39700654033204763.
- The normalized CRPS is 0.04209686402933842.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12349220440548189.
- The NMSE is 1.0682891663705827.
- The R2 coefficient is -0.14135900690345085.
- The normalized CRPS is 0.4244441821509038.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014880985407534816.
- The NMSE is 0.30550230558996094.
- The R2 coefficient is 0.8811819867844022.
- The normalized CRPS is 0.042034848489903874.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00025101295618790154 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 8/358 LMCs and is better than 98.0% of the permuted DAGs (p-value: 0.02).      |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.6014946348670177.
- The R2 coefficient is 0.39700654033204763.
- The normalized CRPS is 0.042132286386518725.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12351717250180325.
- The NMSE is 1.068170989586291.
- The R2 coefficient is -0.1410111480396335.
- The normalized CRPS is 0.42528309044129237.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014880985407534816.
- The NMSE is 0.3270876464530671.
- The R2 coefficient is 0.8897015308337929.
- The normalized CRPS is 0.04087424803350868.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002448819810982883 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 19/358 LMCs and is better than 88.0% of the permuted DAGs (p-value: 0.12).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.4014974443163002.
- The R2 coefficient is 0.5969980922455391.
- The normalized CRPS is 0.03359923530364473.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12354214059812463.
- The NMSE is 1.068406819979972.
- The R2 coefficient is -0.1416754858560357.
- The normalized CRPS is 0.42609300243161813.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.016370748488043055.
- The NMSE is 0.35193359055705214.
- The R2 coefficient is 0.8749101302546558.
- The normalized CRPS is 0.04548138475113615.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002474412466271225 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 17/358 LMCs and is better than 78.0% of the permuted DAGs (p-value: 0.22).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.6014932399650403.
- The R2 coefficient is 0.39700933534574306.
- The normalized CRPS is 0.04203874705017968.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12350607557010487.
- The NMSE is 1.0681541875424438.
- The R2 coefficient is -0.14096811642335466.
- The normalized CRPS is 0.4259154040957389.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014131942517893802.
- The NMSE is 0.32465265615963257.
- The R2 coefficient is 0.8916448651768928.
- The normalized CRPS is 0.03934158404512607.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00024693509481732434 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 20/358 LMCs and is better than 60.0% of the permuted DAGs (p-value: 0.40).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.8014925425146586.
- The R2 coefficient is 0.19701213035943868.
- The normalized CRPS is 0.049343822810322215.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12353936636520002.
- The NMSE is 1.068563050539426.
- The R2 coefficient is -0.14212008827089959.
- The normalized CRPS is 0.4251450651346532.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.015627254064251233.
- The NMSE is 0.3316120032064239.
- The R2 coefficient is 0.8801448189149486.
- The normalized CRPS is 0.04375285540447012.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00024531286626383597 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 11/358 LMCs and is better than 98.0% of the permuted DAGs (p-value: 0.02).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.6014932399650404.
- The R2 coefficient is 0.39700933534574306.
- The normalized CRPS is 0.04202351641124828.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12353104366642623.
- The NMSE is 1.0682836179836392.
- The R2 coefficient is -0.1413265595945096.
- The normalized CRPS is 0.42494262926970594.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014143039449592188.
- The NMSE is 0.3219040355642776.
- The R2 coefficient is 0.892349677745977.
- The normalized CRPS is 0.03936685888434616.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00024928801089929564 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 19/358 LMCs and is better than 78.0% of the permuted DAGs (p-value: 0.22).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we reject the DAG.                                                                                    |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.6014946348670178.
- The R2 coefficient is 0.3970065403320476.
- The normalized CRPS is 0.04207052252985239.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12352549520057705.
- The NMSE is 1.068347356130635.
- The R2 coefficient is -0.14150992139377788.
- The normalized CRPS is 0.4244610463911064.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014137490983742996.
- The NMSE is 0.3252168297049346.
- The R2 coefficient is 0.8935302175496946.
- The normalized CRPS is 0.039127414856769335.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002460572922087234 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 25/358 LMCs and is better than 88.0% of the permuted DAGs (p-value: 0.12).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.6014946348670177.
- The R2 coefficient is 0.39700654033204763.
- The normalized CRPS is 0.04205292640528306.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12350330133718028.
- The NMSE is 1.0682227221728624.
- The R2 coefficient is -0.14116532312247254.
- The normalized CRPS is 0.4243578231750894.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014878211174610221.
- The NMSE is 0.33451377645848.
- The R2 coefficient is 0.8870021598697007.
- The normalized CRPS is 0.041329761967012414.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002421255857236737 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 14/358 LMCs and is better than 92.0% of the permuted DAGs (p-value: 0.08).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.6014932399650403.
- The R2 coefficient is 0.39700933534574306.
- The normalized CRPS is 0.04209617799931588.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12350884980302945.
- The NMSE is 1.068214021560036.
- The R2 coefficient is -0.1411374513566115.
- The normalized CRPS is 0.4243797223979193.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014137490983742992.
- The NMSE is 0.31503759878434423.
- The R2 coefficient is 0.8960622369235998.
- The normalized CRPS is 0.03863665788636646.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002500883166929313 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 22/358 LMCs and is better than 90.0% of the permuted DAGs (p-value: 0.10).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.8014925425146586.
- The R2 coefficient is 0.19701213035943863.
- The normalized CRPS is 0.049368082753980705.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.1234866559396327.
- The NMSE is 1.0685108899423916.
- The R2 coefficient is -0.14199350085205237.
- The normalized CRPS is 0.42460487731634017.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.0141319425178938.
- The NMSE is 0.31513666061016565.
- The R2 coefficient is 0.8930381309504783.
- The normalized CRPS is 0.03912585745971918.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002500883166929313 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 18/358 LMCs and is better than 94.0% of the permuted DAGs (p-value: 0.06).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.6014932399650403.
- The R2 coefficient is 0.39700933534574306.
- The normalized CRPS is 0.042055674714114574.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12351439826887867.
- The NMSE is 1.068246119816054.
- The R2 coefficient is -0.14122601926875417.
- The normalized CRPS is 0.4258209051974317.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014134716750818399.
- The NMSE is 0.28739117399187203.
- The R2 coefficient is 0.8918934630715013.
- The normalized CRPS is 0.03946090766059471.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.0002479667166725985 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 15/358 LMCs and is better than 92.0% of the permuted DAGs (p-value: 0.08).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002979526161016479.
- The NMSE is 0.4014981378385921.
- The R2 coefficient is 0.5969981132606799.
- The normalized CRPS is 0.034800538655822465.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12354491483104921.
- The NMSE is 1.0686151594009168.
- The R2 coefficient is -0.14226702097158855.
- The normalized CRPS is 0.4250051314770819.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.013385673861177385.
- The NMSE is 0.30741000023498166.
- The R2 coefficient is 0.8962214209766266.
- The normalized CRPS is 0.03766959166670866.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00025061536654202854 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 16/358 LMCs and is better than 94.0% of the permuted DAGs (p-value: 0.06).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.002973977695167286.
- The NMSE is 0.4014974443163002.
- The R2 coefficient is 0.5969980922455391.
- The normalized CRPS is 0.03361065536643398.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12350607557010487.
- The NMSE is 1.0683354875021682.
- The R2 coefficient is -0.14148444236069618.
- The normalized CRPS is 0.4266269426531527.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.014134716750818399.
- The NMSE is 0.32175930696954225.
- The R2 coefficient is 0.8919994152181836.
- The normalized CRPS is 0.039414894289396485.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00024552923571152796 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 8/358 LMCs and is better than 98.0% of the permuted DAGs (p-value: 0.02).      |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
"When using this auto assignment function, the given data is used to automatically assign a causal mechanism to each node. Note that causal mechanisms can also be customized and assigned manually.
The following types of causal mechanisms are considered for the automatic selection:

If root node:
An empirical distribution, i.e., the distribution is represented by randomly sampling from the provided data. This provides a flexible and non-parametric way to model the marginal distribution and is valid for all types of data modalities.

If non-root node and the data is continuous:
Additive Noise Models (ANM) of the form X_i = f(PA_i) + N_i, where PA_i are the parents of X_i and the unobserved noise N_i is assumed to be independent of PA_i.To select the best model for f, different regression models are evaluated and the model with the smallest mean squared error is selected.Note that minimizing the mean squared error here is equivalent to selecting the best choice of an ANM.

If non-root node and the data is discrete:
Discrete Additive Noise Models have almost the same definition as non-discrete ANMs, but come with an additional constraint for f to only return discrete values.
Note that 'discrete' here refers to numerical values with an order. If the data is categorical, consider representing them as strings to ensure proper model selection.

If non-root node and the data is categorical:
A functional causal model based on a classifier, i.e., X_i = f(PA_i, N_i).
Here, N_i follows a uniform distribution on [0, 1] and is used to randomly sample a class (category) using the conditional probability distribution produced by a classification model.Here, different model classes are evaluated using the (negative) F1 score and the best performing model class is selected.

In total, 23 nodes were analyzed:

--- Node: map
Node map already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_gaussian_noise
Node lane_line_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_dropout_prob
Node side_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_distance
Node lane_line_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_distance
Node lidar_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_num_lasers
Node lidar_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: num_scenarios
Node num_scenarios already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_num_lasers
Node side_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_gaussian_noise
Node side_detector_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_num_lasers
Node lane_line_detector_num_lasers already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lane_line_detector_dropout_prob
Node lane_line_detector_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: daytime
Node daytime already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_dropout_prob
Node lidar_dropout_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: traffic_density
Node traffic_density already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: side_detector_distance
Node side_detector_distance already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: lidar_gaussian_noise
Node lidar_gaussian_noise already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: accident_prob
Node accident_prob already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: out_of_road
Node out_of_road already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_building
Node crash_building already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_vehicle
Node crash_vehicle already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_human
Node crash_human already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_object
Node crash_object already has a causal mechanism assigned and the override parameter is False. Skipping this node.

--- Node: crash_sidewalk
Node crash_sidewalk already has a causal mechanism assigned and the override parameter is False. Skipping this node.

===Note===
Note, based on the selected auto assignment quality, the set of evaluated models changes.
For more insights toward the quality of the fitted graphical causal model, consider using the evaluate_causal_model function after fitting the causal mechanisms.","Evaluated the performance of the causal mechanisms and the invertibility assumption of the causal mechanisms and the overall average KL divergence between generated and observed distribution and the graph structure. The results are as follows:

==== Evaluation of Causal Mechanisms ====
The used evaluation metrics are:
- KL divergence (only for root-nodes): Evaluates the divergence between the generated and the observed distribution.
- Mean Squared Error (MSE): Evaluates the average squared differences between the observed values and the conditional expectation of the causal mechanisms.
- Normalized MSE (NMSE): The MSE normalized by the standard deviation for better comparison.
- R2 coefficient: Indicates how much variance is explained by the conditional expectations of the mechanisms. Note, however, that this can be misleading for nonlinear relationships.
- F1 score (only for categorical non-root nodes): The harmonic mean of the precision and recall indicating the goodness of the underlying classifier model.
- (normalized) Continuous Ranked Probability Score (CRPS): The CRPS generalizes the Mean Absolute Percentage Error to probabilistic predictions. This gives insights into the accuracy and calibration of the causal mechanisms.
NOTE: Every metric focuses on different aspects and they might not consistently indicate a good or bad performance.
We will mostly utilize the CRPS for comparing and interpreting the performance of the mechanisms, since this captures the most important properties for the causal model.

--- Node map
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node num_scenarios
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_num_lasers
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lane_line_detector_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node daytime
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_dropout_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node traffic_density
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node side_detector_distance
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node lidar_gaussian_noise
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node accident_prob
- The KL divergence between generated and observed distribution is 0.0.
The estimated KL divergence indicates an overall very good representation of the data distribution.

--- Node out_of_road
- The MSE is 0.0029767519280918826.
- The NMSE is 0.8014925425146586.
- The R2 coefficient is 0.19701213035943863.
- The normalized CRPS is 0.04940768478616635.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_building
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_vehicle
- The MSE is 0.12351162403595406.
- The NMSE is 1.0683722080079618.
- The R2 coefficient is -0.14158720501211913.
- The normalized CRPS is 0.4258288430877803.
The estimated CRPS indicates only a fair model performance. Note, however, that a high CRPS could also result from a small signal to noise ratio.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_human
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_object
- The MSE is 0.016367974255118458.
- The NMSE is 0.3522153463903134.
- The R2 coefficient is 0.8731117198892668.
- The normalized CRPS is 0.0458012559858545.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

--- Node crash_sidewalk
- The MSE is 0.0.
- The NMSE is 0.0.
- The R2 coefficient is 1.0.
- The normalized CRPS is 0.0.
The estimated CRPS indicates a very good model performance.
The mechanism is better or equally good than all 7 baseline mechanisms.

==== Evaluation of Invertible Functional Causal Model Assumption ====

--- The model assumption for node crash_human is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_vehicle is rejected with a p-value of 0.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node out_of_road is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_object is rejected with a p-value of 0.00025216713490716636 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might not be valid. This is, the relationship cannot be represent with this type of mechanism or there is a hidden confounder between the node and its parents.

--- The model assumption for node crash_building is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

--- The model assumption for node crash_sidewalk is not rejected with a p-value of 1.0 (after potential adjustment) and a significance level of 0.05.
This implies that the model assumption might be valid.

Note that these results are based on statistical independence tests, and the fact that the assumption was not rejected does not necessarily imply that it is correct. There is just no evidence against it.

==== Evaluation of Generated Distribution ====
The overall average KL divergence between the generated and observed distribution is 0.0
The estimated KL divergence indicates an overall very good representation of the data distribution.

==== Evaluation of the Causal Graph Structure ====
+-------------------------------------------------------------------------------------------------------+
|                                         Falsificaton Summary                                          |
+-------------------------------------------------------------------------------------------------------+
| The given DAG is informative because 0 / 50 of the permutations lie in the Markov                     |
| equivalence class of the given DAG (p-value: 0.00).                                                   |
| The given DAG violates 14/358 LMCs and is better than 92.0% of the permuted DAGs (p-value: 0.08).     |
| Based on the provided significance level (0.2) and because the DAG is informative,                    |
| we do not reject the DAG.                                                                             |
+-------------------------------------------------------------------------------------------------------+

==== NOTE ====
Always double check the made model assumptions with respect to the graph structure and choice of causal mechanisms.
All these evaluations give some insight into the goodness of the causal model, but should not be overinterpreted, since some causal relationships can be intrinsically hard to model. Furthermore, many algorithms are fairly robust against misspecifications or poor performances of causal mechanisms."
